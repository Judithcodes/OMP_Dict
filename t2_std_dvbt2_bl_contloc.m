function cpList = t2_std_dvbt2_bl_contloc(MODE, EXTENDED, SP_PATTERN)

%------------------------------------------------------------------------------
% Procedure
%------------------------------------------------------------------------------
    switch SP_PATTERN
        case 'PP1'
            CP1=[116 255 285 430 518 546 601 646 744 1662 1893 1995 2322 3309 3351 3567 3813 4032 5568 5706];
            CP2=[1022 1224 1302 1371 1495 2261 2551 2583 2649 2833 2925 3192 4266 5395 5710 5881 8164 10568 11069 11560 12631 12946 13954 16745 21494];
            CP3=[];
            CP4=[];
            CP5=[1369 7013 7215 7284 7649 7818 8025 8382 8733 8880 9249 9432 9771 10107 10110 10398 10659 10709 10785 10872 11115 11373 11515 11649 11652 12594 12627 12822 12984 15760 16612 17500 18358 19078 19930 20261 20422 22124 22867 23239 24934 25879 26308 26674];
            CP6=[];
        case 'PP2'
            CP1=[116 318 390 430 474 518 601 646 708 726 1752 1758 1944 2100 2208 2466 3792 5322 5454 5640];
            CP2=[1022 1092 1369 1416 1446 1495 2598 2833 2928 3144 4410 4800 5710 5881 6018 6126 10568 11515 12946 13954 15559 16681];
            CP3=[2261 8164];
            CP4=[10709 19930];
            CP5=[6744 7013 7020 7122 7308 7649 7674 7752 7764 8154 8190 8856 8922 9504 9702 9882 9924 10032 10092 10266 10302 10494 10530 10716 11016 11076 11160 11286 11436 11586 12582 13002 17500 18358 19078 22124 23239 24073 24934 25879 26308];
            CP6=[13164 13206 13476 13530 13536 13764 13848 13938 13968 14028 14190 14316 14526 14556 14562 14658 14910 14946 15048 15186 15252 15468 15540 15576 15630 15738 15840 16350 16572 16806 17028 17064 17250 17472 17784 17838 18180 18246 18480 18900 18960 19254 19482 19638 19680 20082 20310 20422 20454 20682 20874 21240 21284 21444 21450 21522 21594 21648 21696 21738 22416 22824 23016 23124 23196 23238 23316 23418 23922 23940 24090 24168 24222 24324 24342 24378 24384 24540 24744 24894 24990 25002 25194 25218 25260 25566 26674 26944];
            
        case 'PP3'
            CP1=[116 318 342 426 430 518 582 601 646 816 1758 1764 2400 3450 3504 3888 4020 4932 5154 5250 5292 5334];
            CP2=[1022 1495 2261 2551 2802 2820 2833 2922 4422 4752 4884 5710 8164 10568 11069 11560 12631 12946 16745 21494];
            CP3=[13954];
            CP4=[];
            CP5=[1369 5395 5881 6564 6684 7013 7649 8376 8544 8718 8856 9024 9132 9498 9774 9840 10302 10512 10566 10770 10914 11340 11418 11730 11742 12180 12276 12474 12486 15760 16612 17500 18358 19078 19930 20261 20422 22124 22867 23239 24934 25879 26308 26674];
            CP6=[13320 13350 13524 13566 13980 14148 14340 14964 14982 14994 15462 15546 15984 16152 16314 16344 16488 16614 16650 16854 17028 17130 17160 17178 17634 17844 17892 17958 18240 18270 18288 18744 18900 18930 18990 19014 19170 19344 19662 19698 20022 20166 20268 20376 20466 20550 20562 20904 21468];
        case 'PP4'
            CP1=[108 116 144 264 288 430 518 564 636 646 828 2184 3360 3396 3912 4032 4932 5220 5676 5688];
            CP2=[601 1022 1092 1164 1369 1392 1452 1495 2261 2580 2833 3072 4320 4452 5710 5881 6048 10568 11515 12946 13954 15559 16681];
            CP3=[8164];
            CP4=[10709 19930];
            CP5=[6612 6708 7013 7068 7164 7224 7308 7464 7649 7656 7716 7752 7812 7860 8568 8808 8880 9072 9228 9516 9696 9996 10560 10608 10728 11148 11232 11244 11496 11520 11664 11676 11724 11916 17500 18358 19078 21284 22124 23239 24073 24934 25879 26308];
            CP6=[13080 13152 13260 13380 13428 13572 13884 13956 14004 14016 14088 14232 14304 14532 14568 14760 14940 15168 15288 15612 15684 15888 16236 16320 16428 16680 16812 16908 17184 17472 17508 17580 17892 17988 18000 18336 18480 18516 19020 19176 19188 19320 19776 19848 20112 20124 20184 20388 20532 20556 20676 20772 21156 21240 21276 21336 21384 21816 21888 22068 22092 22512 22680 22740 22800 22836 22884 23304 23496 23568 23640 24120 24168 24420 24444 24456 24492 24708 24864 25332 25536 25764 25992 26004 26674 26944];
        case 'PP5'
            CP1=[108 116 228 430 518 601 646 804 1644 1680 1752 1800 1836 3288 3660 4080 4932 4968 5472];
            CP2=[852 1022 1495 2508 2551 2604 2664 2736 2833 3120 4248 4512 4836 5710 5940 6108 8164 10568 11069 11560 12946 13954 21494];
            CP3=[648 4644 16745];
            CP4=[12631];
            CP5=[1369 2261 5395 5881 6552 6636 6744 6900 7032 7296 7344 7464 7644 7649 7668 7956 8124 8244 8904 8940 8976 9216 9672 9780 10224 10332 10709 10776 10944 11100 11292 11364 11496 11532 11904 12228 12372 12816 15760 16612 17500 19078 22867 25879];
            CP6=[];
        case 'PP6'
            CP1=[];
            CP2=[];
            CP3=[];
            CP4=[];
            CP5=[116 384 408 518 601 646 672 960 1022 1272 1344 1369 1495 1800 2040 2261 2833 3192 3240 3768 3864 3984 4104 4632 4728 4752 4944 5184 5232 5256 5376 5592 5616 5710 5808 5881 6360 6792 6960 7013 7272 7344 7392 7536 7649 7680 7800 8064 8160 8164 8184 8400 8808 8832 9144 9648 9696 9912 10008 10200 10488 10568 10656 10709 11088 11160 11515 11592 12048 12264 12288 12312 12552 12672 12946 13954 15559 16681 17500 19078 20422 21284 22124 23239 24934 25879 26308 26674];
            CP6=[13080 13368 13464 13536 13656 13728 13824 14112 14232 14448 14472 14712 14808 14952 15000 15336 15360 15408 15600 15624 15648 16128 16296 16320 16416 16536 16632 16824 16848 17184 17208 17280 17352 17520 17664 17736 17784 18048 18768 18816 18840 19296 19392 19584 19728 19752 19776 20136 20184 20208 20256 21096 21216 21360 21408 21744 21768 22200 22224 22320 22344 22416 22848 22968 23016 23040 23496 23688 23904 24048 24168 24360 24408 24984 25152 25176 25224 25272 25344 25416 25488 25512 25536 25656 25680 25752 25992 26016];
        case 'PP7'
            CP1=[264 360 1848 2088 2112 2160 2256 2280 3936 3960 3984 5016 5136 5208 5664];
            CP2=[116 430 518 601 646 1022 1296 1368 1369 1495 2833 3024 4416 4608 4776 5710 5881 6168 7013 8164 10568 10709 11515 12946 15559 23239 24934 25879 26308 26674];
            CP3=[456 480 2261 6072 17500];
            CP4=[1008 6120 13954];
            CP5=[6984 7032 7056 7080 7152 7320 7392 7536 7649 7704 7728 7752 8088 8952 9240 9288 9312 9480 9504 9840 9960 10320 10368 10728 10752 11448 11640 11688 11808 12192 12240 12480 12816 16681 22124];
            CP6=[13416 13440 13536 13608 13704 13752 14016 14040 14112 14208 14304 14376 14448 14616 14712 14760 14832 14976 15096 15312 15336 15552 15816 15984 16224 16464 16560 17088 17136 17256 17352 17400 17448 17544 17928 18048 18336 18456 18576 18864 19032 19078 19104 19320 19344 19416 19488 19920 19930 19992 20424 20664 20808 21168 21284 21360 21456 21816 22128 22200 22584 22608 22824 22848 22944 22992 23016 23064 23424 23448 23472 23592 24192 24312 24360 24504 24552 24624 24648 24672 24768 24792 25080 25176 25224 25320 25344 25584 25680 25824 26064 26944];
        case 'PP8'
            CP1=[];
            CP2=[];
            CP3=[];
            CP4=[116 132 180 430 518 601 646 1022 1266 1369 1495 2261 2490 2551 2712 2833 3372 3438 4086 4098 4368 4572 4614 4746 4830 4968 5395 5710 5881 7649 8164 10568 11069 11560 12631 12946 13954 15760 16612 16745 17500 19078 19930 21494 22867 25879 26308];
            CP5=[6720 6954 7013 7026 7092 7512 7536 7596 7746 7758 7818 7986 8160 8628 9054 9096 9852 9924 10146 10254 10428 10704 11418 11436 11496 11550 11766 11862 12006 12132 12216 12486 12762 18358 20261 20422 22124 23239 24934];
            CP6=[10709 11515 13254 13440 13614 13818 14166 14274 14304 14364 14586 14664 15030 15300 15468 15474 15559 15732 15774 16272 16302 16428 16500 16662 16681 16872 17112 17208 17862 18036 18282 18342 18396 18420 18426 18732 19050 19296 19434 19602 19668 19686 19728 19938 20034 21042 21120 21168 21258 21284 21528 21594 21678 21930 21936 21990 22290 22632 22788 23052 23358 23448 23454 23706 23772 24048 24072 24073 24222 24384 24402 24444 24462 24600 24738 24804 24840 24918 24996 25038 25164 25314 25380 25470 25974 26076 26674 26753 26944];
    end
    
    switch MODE
        case '1k'
            cpList = mod(CP1, 1632);
        case '2k'
            cpList = mod([CP1 CP2], 1632);
        case '4k'
            cpList = mod([CP1 CP2 CP3], 3264);
        case '8k'
            cpList = mod([CP1 CP2 CP3 CP4], 6528);
        case '16k'
            cpList = mod([CP1 CP2 CP3 CP4 CP5], 13056);
        case '32k'
            cpList = [CP1 CP2 CP3 CP4 CP5 CP6];
    end

    % Add the extra ones in extended carrier mode
	switch MODE
        case '1k'
            ExtCPs = [];
		case '8k'
			switch SP_PATTERN
				case 'PP1'
					ExtCPs = [];
				case 'PP2'
					ExtCPs = [6820 6847 6869 6898];
				case 'PP3' %SP5
					ExtCPs = [6820 6869];
				case 'PP4' %SP8
					ExtCPs = [6820 6869];
				case 'PP5' %SP9
					ExtCPs = [];
				case 'PP6' %SP10
					ExtCPs = [];
				case 'PP7' %SP6
					ExtCPs = [6820 6833 6869 6887 6898];
				case 'PP8' %SP7 
					ExtCPs = [6820 6833 6869 6887 6898];
			end
		case '16k'

			switch SP_PATTERN

				case 'PP1'
					ExtCPs = [13636 13724 13790 13879];
				case 'PP2'
					ExtCPs = [13636 13790];
				case 'PP3' %SP5
					ExtCPs = [13636 13790];
				case 'PP4' %SP8
					ExtCPs = [13636 13790];
				case 'PP5' %SP9
					ExtCPs = [13636 13790];
				case 'PP6' %SP10
					ExtCPs = [13636 13790];
				case 'PP7' %SP6
					ExtCPs = [13636 13724 13879];
				case 'PP8' %SP7
					ExtCPs = [13636 13724 13879];
			end
		case '32k'
			switch SP_PATTERN
				case 'PP1'
					ExtCPs = [];
				case 'PP2'
					ExtCPs = [27268 27688];
				case 'PP3' %SP5
					ExtCPs = [27268 27448 27688 27758];
				case 'PP4' %SP8
					ExtCPs = [27268 27688];
				case 'PP5' %SP9
					ExtCPs = [];
				case 'PP6' %SP10
					ExtCPs = [27268 27448 27688 27758];
				case 'PP7' %SP6
					ExtCPs = [27268 27688];
				case 'PP8' %SP7
					ExtCPs = [27268 27368 27448 27580 27688 27758];
			end

	end

    if (EXTENDED)
        cpList = [cpList ExtCPs];
    end
    cpList = cpList + 1;    % index from 1, for convenience, because that's how Matlab works
    
